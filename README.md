# Описание проекта

Данный проект посвящен созданию ETL-пайплайна по загрузке, трансформации и выгрузке данных о погоде.
В качестве источника данных использован сайт https://open-meteo.com/.
Приложение на Python через API получает данные с сайта и обрабатывает их для дальнейшей передачи в CSV файл и базу данных Postgres.
Обработка включает в себя преобразование единиц измерений, группировку по дням и нахождение агрегатов (среднее, сумма) в рамках суток и светового дня.
Пайплайн запускается в среде контейнера docker-compose. 
База данных Postgres создается и сохраняется как отдельный том в данном контейнере для последующих вставок данных.
Функция загрузки данных в БД обрабатывает дубликаты, не позволяя появиться в БД более, чем 1 записи на каждый день.

## Работа с контейнером

Запустите контейнер:
docker-compose up –d

Проверить его работу можно так:
docker ps

Выполните команду для взаимодействия с контейнером PostgreSQL:
docker exec –it pg_weather_db psql –U weather_user –d weather_database

Создайте структуру базы данных и таблицу:
i\ /scripts/db_init.sql
i\ /scripts/schema.sql
\q

создаем и активируем изолированное виртуальное окружение для проекта:
apt-get update
apt-get install python3-venv
python3 –m venv myenv
source myenv/bin/activate

Установите зависимости:
pip install -r src/requirements.txt

Скрипт запускается следующим образом:
В виде аргументов указаны координаты города, даты начала и конца периода. 
Дополнительно можно указать только сохранение в файл или загрузку в БД. Без указаний выполнится и то, и другое.
python src/shift_de.py --lat 55.0344 --lon 82.9434 --start-date 2025-05-16 --end-date 2025-05-30

проверка вставки в БД
Psql –h localhost –U weather_user –d weather_database –p 5432
ввод пароля: weather_pass (НЕ ВИДНО)
SELECT date, rain_mm FROM weather_schema.weather_records LIMIT 10;

можно остановить контейнер
docker stop pg_weather_db
позднее возобновив его работу
docker start pg_weather_db
или удалить контейнер, оставив тома и образы
docker-compose down